plugins {
    id("maven-publish")
    id("com.jfrog.artifactory").version("4.21.0")
}

group("user11681")
version("1.3.0")

allprojects {
    plugins.apply("java-library")

    repositories {
        mavenCentral()

        maven {url = "https://auoeke.jfrog.io/artifactory/maven"}
    }

    dependencies {
        api("net.gudenau.lib:unsafe:latest.release")
    }
}

sourceCompatibility = 8
targetCompatibility = 8

java {
    withSourcesJar()
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId(project.group)
            artifactId(project.name)
            version(project.version)

            from(components.java)
        }
    }

    repositories {
        mavenLocal()
    }
}

artifactory {
    publish {
        contextUrl = "https://auoeke.jfrog.io/artifactory"

        repository {
            repoKey = "maven"
            username = System.env["ARTIFACTORY_USERNAME"]
            password = System.env["ARTIFACTORY_PASSWORD"]
        }

        defaults {
            publications("maven")
        }
    }
}
